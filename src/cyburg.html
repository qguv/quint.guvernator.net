<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="favicon.png">
    <title>CYBURG</title>
</head>
<body>
    <h1>CYBURG</h1>
    <table>
        <thead>
            <tr class="header">
                <th>suffix</th>
                <th>hardware</th>
                <th>code</th>
                <th>location</th>
                <th>commands</th>
            </tr>
        </thead>
    <tbody>
        <tr>
            <td><a href="http://192.168.2.150">150</a></td>
            <td><a href="https://www.itead.cc/sonoff-s26-wifi-smart-plug.html">Sonoff<a></td>
            <td><a href="https://github.com/arendst/Tasmota/wiki/Commands">Tasmota</a> (autopijp00)</td>
            <td>speakers</td>
            <td><a class="cmd" href="http://192.168.2.150/cm?cmnd=power1%202">toggle</a></td>
        </tr>
        <tr>
            <td><a href="http://192.168.2.151">151</a></td>
            <td><a href="https://www.itead.cc/sonoff-s26-wifi-smart-plug.html">Sonoff<a></td>
            <td><a href="https://github.com/arendst/Tasmota/wiki/Commands">Tasmota</a> (autopijp01)</td>
            <td>windows</td>
            <td><a class="cmd" href="http://192.168.2.151/cm?cmnd=power1%202">toggle</a></td>
        </tr>
        <tr>
            <td><a href="http://192.168.2.152">152</a></td>
            <td><a href="https://www.itead.cc/sonoff-s26-wifi-smart-plug.html">Sonoff<a></td>
            <td><a href="https://github.com/arendst/Tasmota/wiki/Commands">Tasmota</a> (autopijp03)</td>
            <td>sofa</td>
            <td><a class="cmd" href="http://192.168.2.152/cm?cmnd=power1%202">toggle</a></td>
        </tr>
        <tr>
            <td><a href="http://192.168.2.153">153</a></td>
            <td><a href="https://www.itead.cc/sonoff-s26-wifi-smart-plug.html">Sonoff<a></td>
            <td><a href="https://github.com/arendst/Tasmota/wiki/Commands">Tasmota</a> (autopijp03)</td>
            <td>bedroom</td>
            <td><a class="cmd" href="http://192.168.2.153/cm?cmnd=power1%202">toggle</a></td>
        </tr>
        <tr>
            <td><a href="http://192.168.2.154">154</a></td>
            <td><a href="https://www.itead.cc/sonoff-s26-wifi-smart-plug.html">Sonoff<a></td>
            <td><a href="https://github.com/arendst/Tasmota/wiki/Commands">Tasmota</a> (autopijp04)</td>
            <td>desk</td>
            <td><a class="cmd" href="http://192.168.2.154/cm?cmnd=power1%202">toggle</a></td>
        </tr>
        <tr>
            <td>â€”</td>
        </tr>
        <tr>
            <td><a href="http://192.168.2.160">160</a></td>
            <td><a href="https://www.espressif.com/products/hardware/esp8266ex/overview/">ESP-8266</a></td>
            <td><a href="https://github.com/qguv/ledpijp">ledpijp</a></td>
            <td>bathroom</td>
            <td><a class="cmd" href="http://192.168.2.160/a/rainbow">rainbow</a> <a class="cmd" href="http://192.168.2.160/a/night">night</a></td>
        </tr>
    </tbody>
    </table>
    <script>
        for (let a of document.querySelectorAll('a.cmd')) {
            a.dataset.cmd = a.href;
            a.href = '#';
            a.addEventListener('click', function() {
                this.dataset.restore = this.innerHTML;
                this.innerHTML = '. . .';
                fetch(this.dataset.cmd)
                    .then(response => response.json())
                    .then(data => new Promise((resolve, reject) => {
                        if (data.POWER === 'OFF') {
                            this.innerHTML = 'turn on';
                            resolve();
                        } else if (data.POWER === 'ON') {
                            this.innerHTML = 'turn off';
                            resolve();
                        }
                        reject();
                    }))
                    .catch(() => this.innerHTML = this.dataset.restore);
                return false;
            });
        }
    </script>
</body>
</html>
